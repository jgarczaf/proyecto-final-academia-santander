{"version":3,"file":"breadcrumb.js","sourceRoot":"","sources":["../../../src/components/breadcrumb/breadcrumb.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, JSX, Prop, Watch } from '@stencil/core';\r\nimport type { BreadcrumbModel } from './breadcrumb.model';\r\n\r\n@Component({\r\n  tag: 'ath-breadcrumb',\r\n  styleUrl: 'breadcrumb.scss',\r\n  shadow: true,\r\n})\r\nexport class AthBreadcrumb {\r\n  /** Opciones normalizadas del breadcrumb */\r\n  private _options: BreadcrumbModel[] = [];\r\n\r\n  /**\r\n   * Si es true y el breadcrumb tiene más de 4 elementos,\r\n   * el breadcrumb se renderiza colapsado.\r\n   *\r\n   * Al hacer click en \"...\" este valor se alterna.\r\n   */\r\n  @Prop({ reflect: true }) collapsed: boolean = false;\r\n\r\n  /** Separador entre los enlaces del breadcrumb */\r\n  @Prop() separator: string = '/';\r\n\r\n  /**\r\n   * Lista de enlaces del breadcrumb.\r\n   * Normalmente se recibe como un string JSON desde HTML.\r\n   */\r\n  @Prop() options: any;\r\n\r\n  /**\r\n   * Definición de un aria-label personalizado para el breadcrumb\r\n   */\r\n  @Prop() athAriaLabel?: string;\r\n\r\n\r\n  /**\r\n   * Observa cambios en la prop options y la normaliza\r\n   * a un array de BreadcrumbModel\r\n   */\r\n  @Watch('options')\r\n  watchOptions(): void {\r\n    this._options = this.parseOptions(this.options);\r\n  }\r\n\r\n  // @Watch('collapsed')\r\n  // watchCollapsed(newValue: boolean): void {\r\n  //   console.log('collapsed changed to', newValue);\r\n  // }\r\n\r\n  /** Ciclo de vida ejecutado antes del primer render */\r\n  componentWillLoad(): void {\r\n    this.watchOptions();\r\n  }\r\n\r\n  /** Maneja el click en el botón \"...\" para expandir/colapsar */\r\n  private _handleClick = (): void => {\r\n    this.collapsed = !this.collapsed;\r\n    \r\n  };\r\n\r\n  /**\r\n   * Parsea las opciones del breadcrumb.\r\n   * Soporta:\r\n   * - Array\r\n   * - String JSON\r\n   * - Objeto con claves numéricas\r\n   */\r\n  private parseOptions(input: any): BreadcrumbModel[] {\r\n    if (input == null) return [];\r\n\r\n    // Si ya es un array\r\n    if (Array.isArray(input)) {\r\n      return input.map((it) => ({\r\n        ...it,\r\n        url: it.url ?? '#',\r\n      }));\r\n    }\r\n\r\n    // Si es un string JSON\r\n    if (typeof input === 'string') {\r\n      try {\r\n        return this.parseOptions(JSON.parse(input));\r\n      } catch {\r\n        return [];\r\n      }\r\n    }\r\n\r\n    // Si es un objeto (posiblemente con claves \"0\", \"1\", \"2\", ...)\r\n    if (typeof input === 'object') {\r\n      const keys = Object.keys(input);\r\n      const numericKeys = keys.every((k) => /^[0-9]+$/.test(k));\r\n\r\n      const values = numericKeys\r\n        ? keys\r\n            .map((k) => Number(k))\r\n            .sort((a, b) => a - b)\r\n            .map((n) => input[String(n)])\r\n        : Object.values(input);\r\n\r\n      return (values as BreadcrumbModel[]).map((it) => ({\r\n        ...it,\r\n        url: it.url ?? '#',\r\n      }));\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * Renderiza los enlaces del breadcrumb.\r\n   * - Si hay más de 4 elementos y collapsed es true:\r\n   *   se muestran solo el primero y el último, con un botón \"...\"\r\n   * - En caso contrario, se muestran todos los enlaces\r\n   */\r\n  private _renderLinks(options: BreadcrumbModel[]): JSX.Element[] {\r\n    const lastIndex = options.length - 1;\r\n    const canCollapse = options.length > 4 && this.collapsed === true;\r\n    const middleIndex = Math.floor(lastIndex / 2);\r\n\r\n    // Renderizado normal (sin colapsar)\r\n    if (!canCollapse) {\r\n      return options.map((option, i) => (\r\n        <div class=\"ath-breadcrumb__container-link\">\r\n          <a\r\n            href={option.url}\r\n            id={`link--${option.id}`}\r\n            {...(i === lastIndex ? { 'aria-current': 'page' } : {})}\r\n          >\r\n            {option.icon && (\r\n              <span class=\"ath-breadcrumb__icon\">\r\n                <ath-icon icon={option.icon} size='sm'></ath-icon>\r\n              </span>\r\n            )}\r\n            {option.name}\r\n          </a>\r\n\r\n          {i === lastIndex ? '' : (\r\n            <span class=\"ath-breadcrumb__separator\">{this.separator}</span>\r\n          )}\r\n        </div>\r\n      ));\r\n    }\r\n\r\n    // Renderizado colapsado\r\n    return options.map((option, i) => {\r\n      const isFirst = i === 0;\r\n      const isLast = i === lastIndex;\r\n\r\n      return (\r\n        <div>\r\n          {isFirst || isLast ? (\r\n            <div class=\"ath-breadcrumb__container-link hidden--false\">\r\n              <a\r\n                href={option.url}\r\n                id={`link--${option.id}`}\r\n                {...(isLast ? { 'aria-current': 'page' } : {})}\r\n              >\r\n                {option.name}\r\n              </a>\r\n\r\n              {isLast ? '' : (\r\n                <span class=\"ath-breadcrumb__separator\">{this.separator}</span>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            <div class={`ath-breadcrumb__container-link hidden--${this.collapsed}`}>\r\n              <a href={option.url} id={`link--${option.id}`}>\r\n                {option.name}\r\n              </a>\r\n              <span class=\"ath-breadcrumb__separator\">{this.separator}</span>\r\n            </div>\r\n          )}\r\n\r\n          {i === middleIndex ? (\r\n            <div class={`ath-breadcrumb__button hidden--${!this.collapsed}`}>\r\n              <button\r\n                type=\"button\"\r\n                aria-label=\"Mostrar ruta completa del breadcrumb\"\r\n                onClick={this._handleClick}\r\n              >\r\n                ...\r\n              </button>\r\n              <span class=\"ath-breadcrumb__separator\">{this.separator}</span>\r\n            </div>\r\n          ) : (\r\n            ''\r\n          )}\r\n        </div>\r\n      );\r\n    });\r\n  }\r\n\r\n  /** Render principal del componente */\r\n  render(): JSX.Element {\r\n    return (\r\n      <Host>\r\n        <nav\r\n          class=\"ath-breadcrumb\"\r\n          aria-label={this.athAriaLabel ?? 'Breadcrumb'}\r\n        >\r\n          {this._renderLinks(this._options)}\r\n        </nav>\r\n      </Host>\r\n    );\r\n  }\r\n\r\n}\r\n"]}