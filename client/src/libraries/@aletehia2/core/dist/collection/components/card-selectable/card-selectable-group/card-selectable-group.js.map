{"version":3,"file":"card-selectable-group.js","sourceRoot":"","sources":["../../../../src/components/card-selectable/card-selectable-group/card-selectable-group.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, ComponentInterface, Host, Prop, h, Event, EventEmitter, Listen, Element } from '@stencil/core';\r\nimport { CardSelectableGroupSize, CardSelectableGroupSizes } from './card-selectable-group.model';\r\n\r\n@Component({\r\n  tag: 'ath-card-selectable-group',\r\n})\r\nexport class AthCardSelectableGroup implements ComponentInterface {\r\n  @Element() el: HTMLAthCardSelectableGroupElement;\r\n\r\n  /**\r\n   * Indicates whether the card selectable group is disabled\r\n   **/\r\n  @Prop() disabled = false;\r\n\r\n  /**\r\n   * Indicates whether the group is multi selection\r\n   **/\r\n  @Prop() multiple = false;\r\n\r\n  /**\r\n   * Size for the cards\r\n   */\r\n  @Prop() size: CardSelectableGroupSizes = CardSelectableGroupSize.Small;\r\n\r\n  @Event() athValueChanged: EventEmitter<HTMLAthCardSelectableElement[]>;\r\n\r\n  private cards: Array<HTMLAthCardSelectableElement> = [];\r\n  private selectedCard: number;\r\n  private firstEnabledCard: number;\r\n  private lastEnabledCard: number;\r\n\r\n  private firstTimeLoad = true;\r\n\r\n  @Listen('keydown')\r\n  handleKeyDown(e: KeyboardEvent) {\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        this.movePreviousCard();\r\n        break;\r\n\r\n      case 'ArrowRight':\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        this.moveNextCard();\r\n        break;\r\n\r\n      case 'Home':\r\n        e.preventDefault();\r\n        this.selectFocusCard(this.firstEnabledCard);\r\n        break;\r\n      case 'End':\r\n        e.preventDefault();\r\n        this.selectFocusCard(this.lastEnabledCard);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  @Listen('athChange')\r\n  handleChange(e: CustomEvent) {\r\n    if (!this.multiple) {\r\n      this.removePreviousCheckedCards(e.detail);\r\n    }\r\n    e.detail.select(this.firstTimeLoad);\r\n\r\n    this.cards.forEach((card, index) => {\r\n      if (card === e.detail) {\r\n        this.selectedCard = index;\r\n      } else {\r\n        card.tabIndex = -1;\r\n      }\r\n    });\r\n\r\n    this.emitCheckedCards();\r\n  }\r\n\r\n  private emitCheckedCards(): void {\r\n    const cards = this.cards.filter(card => card.selected);\r\n    this.athValueChanged.emit(cards);\r\n  }\r\n\r\n  private removePreviousCheckedCards(currentCard: HTMLAthCardSelectableElement) {\r\n    this.cards.forEach(card => {\r\n      if (card.selected && card !== currentCard) {\r\n        card.unselect();\r\n        card.tabIndex = -1;\r\n        card.selected = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  private moveNextCard() {\r\n    const next = this.cards.findIndex((card, index) => index > this.selectedCard && !card.disabled);\r\n    this.selectFocusCard(next === -1 ? this.firstEnabledCard : next);\r\n  }\r\n\r\n  private movePreviousCard() {\r\n    let prevIndex = this.selectedCard - 1;\r\n\r\n    while (prevIndex >= 0 && this.cards[prevIndex].disabled) {\r\n      prevIndex--;\r\n    }\r\n\r\n    this.selectFocusCard(prevIndex === -1 ? this.lastEnabledCard : prevIndex);\r\n  }\r\n\r\n  private getFirstEnabledCard(): number {\r\n    return this.cards.findIndex(card => !card.disabled);\r\n  }\r\n\r\n  private getLastEnabledCard(): number {\r\n    for (let index = this.cards.length - 1; index >= 0; index--) {\r\n      if (!this.cards[index].disabled) {\r\n        return index;\r\n      }\r\n    }\r\n\r\n    return -1;\r\n  }\r\n\r\n  private getFirstCheckedCard(): number {\r\n    const index = this.cards.findIndex(card => card.selected && !card.disabled);\r\n    return index;\r\n  }\r\n\r\n  private selectFocusCard(index: number) {\r\n    this.selectedCard = index;\r\n    this.cards.forEach(card => {\r\n      card.unselect();\r\n      card.tabIndex = -1;\r\n    });\r\n    if (this.cards.length > 0) {\r\n      this.cards[this.selectedCard].select(this.firstTimeLoad);\r\n      this.cards[this.selectedCard].tabIndex = 0;\r\n      this.firstTimeLoad = false;\r\n    }\r\n  }\r\n\r\n  private loadCards(): void {\r\n    this.cards = this.getCards();\r\n    this.firstEnabledCard = this.getFirstEnabledCard();\r\n    this.lastEnabledCard = this.getLastEnabledCard();\r\n\r\n    const firstChecked = this.getFirstCheckedCard();\r\n    this.selectFocusCard(firstChecked > -1 ? firstChecked : this.firstEnabledCard);\r\n  }\r\n\r\n  private getCards(): Array<HTMLAthCardSelectableElement> {\r\n    const cardsElements = this.el.querySelectorAll('ath-card-selectable');\r\n    const cards = [];\r\n\r\n    if (cardsElements) {\r\n      cardsElements.forEach(card => {\r\n        cards.push(card);\r\n      });\r\n    }\r\n\r\n    return cards;\r\n  }\r\n\r\n  private propagateAttributes() {\r\n    if (this.cards.length > 0) {\r\n      this.cards.forEach(card => {\r\n        this.propagateAttribute(card);\r\n      });\r\n    }\r\n  }\r\n\r\n  private propagateAttribute(card: HTMLAthCardSelectableElement) {\r\n    if (this.disabled !== null && !card.hasAttribute('disabled')) {\r\n      card.setAttribute('disabled', this.disabled.toString());\r\n    }\r\n\r\n    if (this.size && !card.hasAttribute('size')) {\r\n      card.setAttribute('size', this.size);\r\n    }\r\n\r\n    if (this.multiple) {\r\n      card.type = 'multiselect';\r\n    }\r\n  }\r\n\r\n  componentDidLoad(): void {\r\n    this.loadCards();\r\n    this.propagateAttributes();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host role={this.multiple ? 'group' : 'radiogroup'}>\r\n        <slot />\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}