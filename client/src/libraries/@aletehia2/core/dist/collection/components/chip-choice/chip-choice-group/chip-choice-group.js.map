{"version":3,"file":"chip-choice-group.js","sourceRoot":"","sources":["../../../../src/components/chip-choice/chip-choice-group/chip-choice-group.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, ComponentInterface, JSX, Host, Prop, h, Element, Listen, Event, EventEmitter, AttachInternals, Watch } from '@stencil/core';\r\nimport { ChipChoiceSize, ChipChoiceSizes } from '../chip-choice.model';\r\n\r\n@Component({\r\n  tag: 'ath-chip-choice-group',\r\n  styleUrls: ['chip-choice-group.scss'],\r\n  shadow: true,\r\n  formAssociated: true,\r\n})\r\nexport class AthChipChoiceGroup implements ComponentInterface {\r\n  @Element() el: HTMLAthChipChoiceGroupElement;\r\n\r\n  @AttachInternals() internals: ElementInternals;\r\n\r\n  /**\r\n   * Weather the chips are disabled\r\n   */\r\n  @Prop() disabled = false;\r\n\r\n  /**\r\n   * Allow multiple selection of chips\r\n   */\r\n  @Prop() multiple = false;\r\n\r\n  /**\r\n   * The generic name for the chips\r\n   */\r\n  @Prop() name: string;\r\n\r\n  /**\r\n   * The generic size of the chips\r\n   */\r\n  @Prop() size: ChipChoiceSizes = ChipChoiceSize.Medium;\r\n\r\n  /**\r\n   * The width of the group\r\n   */\r\n  @Prop() width: string;\r\n\r\n  /**\r\n   * The value for not multiple (use chip-choice-group as radio-group)\r\n   */\r\n  @Prop({ mutable: true }) value: string;\r\n\r\n  @Watch('value')\r\n  watchValueHandler(newValue: string) {\r\n    this.selectByValue(newValue);\r\n  }\r\n\r\n  /**\r\n   * Event to emit the current chips checked\r\n   */\r\n  @Event() athChangeValue: EventEmitter<HTMLAthChipChoiceElement[]>;\r\n\r\n  @Listen('athChange')\r\n  handleChange(e: CustomEvent) {\r\n    e.stopPropagation();\r\n    if (this.multiple) {\r\n      this.selectedChip = this.getChipIndex(e.detail);\r\n    } else {\r\n      this.selectByValue(e.detail.value);\r\n      this.setValue();\r\n    }\r\n    this.emitCheckedChips();\r\n  }\r\n\r\n  @Listen('keydown')\r\n  handleMouseDown(e: KeyboardEvent) {\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        this.movePreviousChip();\r\n        break;\r\n\r\n      case 'ArrowRight':\r\n        this.moveNextChip();\r\n        break;\r\n\r\n      case 'Home':\r\n        this.selectFocusChip(this.firstEnabledChip);\r\n        break;\r\n      case 'End':\r\n        this.selectFocusChip(this.lastEnabledChip);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  private chips: Array<HTMLAthChipChoiceElement> = [];\r\n  private selectedChip: number;\r\n  private firstEnabledChip: number;\r\n  private lastEnabledChip: number;\r\n  private initialValue: string;\r\n\r\n  componentDidLoad(): void {\r\n    this.loadChips();\r\n    this.propagateAttributes();\r\n    this.initialValue = this.value;\r\n\r\n    if (this.value) {\r\n      this.selectByValue(this.value);\r\n      this.setInputValue(this.value);\r\n    } else {\r\n      this.setFocusFirstChip();\r\n    }\r\n  }\r\n\r\n  formResetCallback() {\r\n    this.value = this.initialValue;\r\n    this.selectByValue(this.value);\r\n    this.setInputValue(this.initialValue);\r\n    this.emitCheckedChips();\r\n  }\r\n\r\n  private loadChips(): void {\r\n    this.chips = this.getChips();\r\n    this.firstEnabledChip = this.getFirstEnabledChip();\r\n    this.lastEnabledChip = this.getLastEnabledChip();\r\n  }\r\n\r\n  private setFocusFirstChip() {\r\n    const firstChecked = this.getFirstCheckedChip();\r\n    this.selectFocusChip(firstChecked > -1 ? firstChecked : this.firstEnabledChip);\r\n  }\r\n\r\n  private getChips(): Array<HTMLAthChipChoiceElement> {\r\n    const chipsElements = this.el.querySelectorAll('ath-chip-choice');\r\n    const chips = [];\r\n\r\n    if (chipsElements) {\r\n      chipsElements.forEach(chip => {\r\n        chips.push(chip);\r\n      });\r\n    }\r\n\r\n    return chips;\r\n  }\r\n\r\n  private propagateAttributes() {\r\n    if (this.chips) {\r\n      this.chips.forEach(chip => {\r\n        this.propagateAttribute(chip);\r\n      });\r\n    }\r\n  }\r\n\r\n  private propagateAttribute(chip: HTMLAthChipChoiceElement) {\r\n    if (!chip) {\r\n      return;\r\n    }\r\n\r\n    chip.role = this.multiple ? 'checkbox' : 'radio';\r\n\r\n    // Boolean attibute propagate only for true\r\n    if (this.disabled) {\r\n      chip.disabled = true;\r\n    }\r\n\r\n    if (this.size && !chip.hasAttribute('size')) {\r\n      chip.setAttribute('size', this.size);\r\n    }\r\n\r\n    if (this.name && this.multiple) {\r\n      chip.setAttribute('name', this.name);\r\n    } else {\r\n      chip.removeAttribute('name');\r\n    }\r\n  }\r\n\r\n  private getFirstEnabledChip(): number {\r\n    return this.chips.findIndex(chip => !chip.disabled);\r\n  }\r\n\r\n  private getLastEnabledChip(): number {\r\n    for (let index = this.chips.length - 1; index >= 0; index--) {\r\n      if (!this.chips[index].disabled) {\r\n        return index;\r\n      }\r\n    }\r\n\r\n    return -1;\r\n  }\r\n\r\n  private getFirstCheckedChip(): number {\r\n    const index = this.chips.findIndex(chip => chip.selected && !chip.disabled);\r\n    return index;\r\n  }\r\n\r\n  private getChipIndex(chip: HTMLAthChipChoiceElement) {\r\n    return this.chips.findIndex(item => item === chip);\r\n  }\r\n\r\n  private getHostStyles() {\r\n    return {\r\n      width: this.width || undefined,\r\n    };\r\n  }\r\n\r\n  private moveNextChip() {\r\n    const next = this.chips.findIndex((chip, index) => index > this.selectedChip && !chip.disabled);\r\n    this.selectFocusChip(next === -1 ? this.firstEnabledChip : next);\r\n  }\r\n\r\n  private movePreviousChip() {\r\n    let prevIndex = this.selectedChip - 1;\r\n\r\n    while (prevIndex >= 0 && this.chips[prevIndex].disabled) {\r\n      prevIndex--;\r\n    }\r\n\r\n    this.selectFocusChip(prevIndex === -1 ? this.lastEnabledChip : prevIndex);\r\n  }\r\n\r\n  private selectFocusChip(index: number) {\r\n    this.selectedChip = index;\r\n    this.chips.forEach(chip => {\r\n      chip.unselect();\r\n    });\r\n    this.chips[this.selectedChip].select();\r\n  }\r\n\r\n  private selectByValue(value: string): void {\r\n    if (!this.multiple) {\r\n      this.unCheckAllChips();\r\n      const selectedIndex = this.chips.findIndex(chip => chip.value === value);\r\n      this.selectedChip = selectedIndex;\r\n      if (selectedIndex !== -1) {\r\n        this.chips[selectedIndex].selected = true;\r\n        this.chips[selectedIndex].select();\r\n      }\r\n    }\r\n  }\r\n\r\n  private unCheckAllChips() {\r\n    this.chips.forEach(chip => {\r\n      chip.selected = false;\r\n      chip.unselect();\r\n    });\r\n  }\r\n\r\n  private emitCheckedChips(): void {\r\n    const chips = this.chips.filter(chip => chip.selected);\r\n    this.athChangeValue.emit(chips);\r\n  }\r\n\r\n  private setValue() {\r\n    if (!this.multiple) {\r\n      const value = this.selectedChip > -1 ? this.chips[this.selectedChip].value : '';\r\n      this.value = value;\r\n      this.setInputValue(value);\r\n    }\r\n  }\r\n\r\n  private setInputValue(value: string): void {\r\n    if (!this.multiple && this.internals && 'setFormValue' in this.internals) {\r\n      this.internals.setFormValue(value);\r\n      this.internals.checkValidity();\r\n    }\r\n  }\r\n\r\n  render(): JSX.Element {\r\n    return (\r\n      <Host role={this.multiple ? 'group' : 'radiogroup'} style={this.getHostStyles()}>\r\n        <slot />\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}