{"version":3,"file":"modal.js","sourceRoot":"","sources":["../../../src/components/modal/modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Prop, Element, h, JSX, Host, ComponentInterface, Event, EventEmitter, Method, Listen } from '@stencil/core';\r\nimport { ModalSize, ModalAppearance, ModalAppearanceType, ModalSizeType } from './modal.model';\r\nimport { FcButtonComp, FcPictogram } from 'sharedfc/input';\r\nimport { ButtonIconPosition } from 'components/button/button.model';\r\nimport { IconSize } from '@utils/helper';\r\nimport { getHeading } from '@utils/helper/heading';\r\n\r\n@Component({\r\n  tag: 'ath-modal',\r\n  styleUrls: ['modal.scss'],\r\n  shadow: true,\r\n})\r\nexport class AthModal implements ComponentInterface {\r\n  @Element() el: HTMLElement;\r\n  /**\r\n   * Indicates the illustration used when the prop isAlert is set to true\r\n   */\r\n  @Prop() appearance: ModalAppearanceType = ModalAppearance.Error;\r\n\r\n  /**\r\n   * Indicates whether the modal should automatically focus the first interactive element\r\n   */\r\n  @Prop() autofocus: boolean = true;\r\n\r\n  /**\r\n   * Indicates whether the modal should close when clicking outside\r\n   */\r\n  @Prop() clickOutsideClose: boolean = false;\r\n\r\n  /**\r\n   * Indicates whether the modal will occupy the full screen\r\n   */\r\n  @Prop() fullScreen: boolean = false;\r\n\r\n  /**\r\n   * Indicates whether the modal has a close (X) button\r\n   */\r\n  @Prop() hasClose: boolean = true;\r\n\r\n  /**\r\n   * Indicates whether there is a divider between the header and the slots\r\n   */\r\n  @Prop() hasDivider: boolean = false;\r\n\r\n  /**\r\n   * Indicates the heading level of the title\r\n   */\r\n  @Prop() headingLevel = 2;\r\n\r\n  /**\r\n   * Indicates the title text\r\n   */\r\n  @Prop() headingText: string;\r\n\r\n  /**\r\n   * Indicates whether the modal has role \"Alert\", and interrupts the screen reader flow\r\n   */\r\n  @Prop() isAlert: boolean = false;\r\n\r\n  /**\r\n   * Indicates the maximum height of the modal\r\n   */\r\n  @Prop() maxHeight: string;\r\n\r\n  /**\r\n   * Indicates the maximum width of the modal\r\n   */\r\n  @Prop() maxWidth: string;\r\n\r\n  /**\r\n   * Indicates whether the modal is displayed by default\r\n   */\r\n  @Prop({ mutable: true }) open = false;\r\n\r\n  /**\r\n   * Differentiates the modal size between sm and md\r\n   */\r\n  @Prop() size: ModalSizeType = ModalSize.Medium;\r\n\r\n  /**\r\n   * Indicates the subtitle text\r\n   */\r\n  @Prop() subtitleText: string;\r\n\r\n  // ACCESSIBILITY\r\n  /**\r\n   * Accessible text for the close (X) button\r\n   */\r\n  @Prop() closeAriaLabel: string;\r\n\r\n  // EVENTS\r\n  /**\r\n   * Emitted when the modal is opened\r\n   */\r\n  @Event() athOpened: EventEmitter<void>;\r\n\r\n  // EVENTS\r\n  /**\r\n   * Emitted when the modal is closed\r\n   */\r\n  @Event() athClosed: EventEmitter<void>;\r\n\r\n  /**\r\n   * Method to open the modal\r\n   */\r\n  @Method()\r\n  async openModal() {\r\n    this.open = true;\r\n    this.previouslyFocusedElement = this.getDeepActiveElement() as HTMLElement;\r\n\r\n    requestAnimationFrame(() => {\r\n      this.focusableElements = this.findFocusableElements();\r\n\r\n      if (this.autofocus) {\r\n        this.focusFirstElement();\r\n      } else {\r\n        this.blurOuterElement();\r\n      }\r\n\r\n      this.athOpened.emit();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Method to close the modal\r\n   */\r\n  @Method()\r\n  async closeModal() {\r\n    this.open = false;\r\n    if (this.previouslyFocusedElement) {\r\n      this.previouslyFocusedElement.focus();\r\n    }\r\n\r\n    this.athClosed.emit();\r\n  }\r\n\r\n  private previouslyFocusedElement: HTMLElement | null = null;\r\n  private focusableElements: HTMLElement[] = [];\r\n\r\n  @Listen('keydown')\r\n  handleKeyDown(e: KeyboardEvent) {\r\n    if (this.open) {\r\n      if (e.key === 'Escape') {\r\n        this.closeModal();\r\n      }\r\n\r\n      if (e.key === 'Tab') {\r\n        if (this.focusableElements.length !== 0) {\r\n          this.trapFocus(e);\r\n        } else {\r\n          e.preventDefault();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private findFocusableElements(): HTMLElement[] {\r\n    const results = new Set<HTMLElement>();\r\n    const focusableSelector = [\r\n      'button:not([disabled]):not([tabindex=\"-1\"])',\r\n      'a[href]:not([tabindex=\"-1\"])',\r\n      'input:not([disabled]):not([type=\"hidden\"]):not([tabindex=\"-1\"])',\r\n      'select:not([disabled]):not([tabindex=\"-1\"])',\r\n      'textarea:not([disabled]):not([tabindex=\"-1\"])',\r\n      'details:not([tabindex=\"-1\"])',\r\n      'area[href]:not([tabindex=\"-1\"])',\r\n      '[contentEditable=true]:not([tabindex=\"-1\"])',\r\n      'iframe:not([tabindex=\"-1\"])',\r\n      '[tabindex]:not([tabindex=\"-1\"])',\r\n    ].join(',');\r\n\r\n    const visited = new WeakSet<Node>();\r\n\r\n    const traverse = (node: Node) => {\r\n      if (!node || visited.has(node)) return;\r\n      visited.add(node);\r\n\r\n      if (node instanceof HTMLElement) {\r\n        const style = window.getComputedStyle(node);\r\n        const isVisible = style.display !== 'none' && style.visibility !== 'hidden';\r\n\r\n        if (isVisible && node.matches(focusableSelector)) {\r\n          results.add(node);\r\n        }\r\n\r\n        if (node.shadowRoot) {\r\n          traverse(node.shadowRoot);\r\n        }\r\n\r\n        const shadow = (node as HTMLElement).shadowRoot;\r\n        if (shadow) {\r\n          shadow.querySelectorAll(focusableSelector).forEach(el => {\r\n            if (el instanceof HTMLElement && window.getComputedStyle(el).display !== 'none') {\r\n              results.add(el);\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      node.childNodes.forEach(traverse);\r\n\r\n      if (typeof HTMLSlotElement !== 'undefined' && node instanceof HTMLSlotElement) {\r\n        node.assignedNodes({ flatten: true }).forEach(traverse);\r\n      }\r\n    };\r\n\r\n    traverse(this.el.shadowRoot ?? this.el);\r\n\r\n    return Array.from(results);\r\n  }\r\n\r\n  private focusFirstElement = () => {\r\n    if (this.focusableElements.length > 0) {\r\n      if (this.focusableElements.length > 1 && this.hasClose) {\r\n        this.focusableElements[1].focus();\r\n      } else {\r\n        this.focusableElements[0].focus();\r\n      }\r\n    }\r\n  };\r\n\r\n  private blurOuterElement = () => {\r\n    const modal = this.el.shadowRoot?.querySelector('.ath-modal') as HTMLElement;\r\n    modal?.focus();\r\n  };\r\n\r\n  componentDidLoad(): void {\r\n    if (this.open) {\r\n      this.openModal();\r\n    }\r\n  }\r\n\r\n  private trapFocus = e => {\r\n    if (this.focusableElements.length === 0) return;\r\n\r\n    const first = this.focusableElements[0];\r\n    const last = this.focusableElements[this.focusableElements.length - 1];\r\n    const realActiveElement = this.getDeepActiveElement();\r\n\r\n    if (e.shiftKey) {\r\n      if (realActiveElement === first) {\r\n        e.preventDefault();\r\n        last.focus();\r\n      }\r\n    } else {\r\n      if (realActiveElement === last) {\r\n        e.preventDefault();\r\n        first.focus();\r\n      }\r\n    }\r\n  };\r\n\r\n  private getDeepActiveElement(doc: Document | ShadowRoot = document): Element | null {\r\n    let active = doc.activeElement;\r\n    while (active?.shadowRoot && active.shadowRoot.activeElement) {\r\n      active = active.shadowRoot.activeElement;\r\n    }\r\n    return active;\r\n  }\r\n\r\n  private handleBackdropClick = (e: MouseEvent) => {\r\n    if (e.target === e.currentTarget && this.clickOutsideClose) {\r\n      this.closeModal();\r\n    }\r\n  };\r\n\r\n  private getAccesibilityAttributes = () => ({\r\n    'role': this.isAlert ? 'alertdialog' : 'dialog',\r\n    'aria-describedby': this.subtitleText ? 'subtitleTextId' : undefined,\r\n    'aria-labelledby': this.headingText ? 'headlineTextId' : undefined,\r\n    'aria-modal': 'true',\r\n    'tabindex': '-1',\r\n  });\r\n\r\n  private getDialogClassNames = () => ({\r\n    'ath-modal': true,\r\n    'ath-modal--fullscreen': this.fullScreen,\r\n    [`ath-modal--${this.size}`]: !!this.size,\r\n  });\r\n\r\n  private getHeaderClassNames = () => ({\r\n    'ath-modal-header': true,\r\n    'ath-modal-header--alert': this.isAlert,\r\n  });\r\n\r\n  private getDialogStyle = () => ({\r\n    maxHeight: this.maxHeight || 'unset',\r\n    maxWidth: this.maxWidth || 'unset',\r\n  });\r\n\r\n  private renderHeading = (): JSX.Element => {\r\n    const HeadingTitle = getHeading(this.headingLevel);\r\n    return (\r\n      <HeadingTitle class=\"ath-modal-header-text-title\" id=\"headlineTextId\">\r\n        {this.headingText}\r\n      </HeadingTitle>\r\n    );\r\n  };\r\n\r\n  private renderHeadingSubtitle = (): JSX.Element => {\r\n    return (\r\n      <div class=\"ath-modal-header-text-subtitle\" id=\"subtitleTextId\">\r\n        {this.subtitleText}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render(): JSX.Element {\r\n    if (!this.open) {\r\n      return <Host></Host>;\r\n    }\r\n\r\n    return (\r\n      <Host>\r\n        <div class=\"backdrop\" onClick={this.handleBackdropClick}>\r\n          <div {...this.getAccesibilityAttributes()} class={this.getDialogClassNames()} style={this.getDialogStyle()}>\r\n            <div class={this.getHeaderClassNames()}>\r\n              {this.isAlert && <FcPictogram name={`illu_${this.appearance}_msg`}></FcPictogram>}\r\n              <div class=\"ath-modal-header-text\">\r\n                {this.headingText && this.renderHeading()}\r\n                {this.subtitleText && this.renderHeadingSubtitle()}\r\n              </div>\r\n              {this.hasClose && (\r\n                <div class=\"ath-modal-header-close\">\r\n                  <FcButtonComp\r\n                    icon=\"close_small\"\r\n                    color=\"default\"\r\n                    iconPosition={ButtonIconPosition.IconOnly}\r\n                    size={IconSize.Small}\r\n                    onClick={() => this.closeModal()}\r\n                    buttonAriaLabel={this.closeAriaLabel}\r\n                  ></FcButtonComp>\r\n                </div>\r\n              )}\r\n            </div>\r\n            {this.hasDivider && <ath-divider></ath-divider>}\r\n            <div class=\"scrollable-slot ath-scroll\">\r\n              <slot name=\"body\"></slot>\r\n            </div>\r\n            <slot name=\"footer\"></slot>\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}