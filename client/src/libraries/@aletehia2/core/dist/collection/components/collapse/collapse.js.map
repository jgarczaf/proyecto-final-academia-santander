{"version":3,"file":"collapse.js","sourceRoot":"","sources":["../../../src/components/collapse/collapse.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ath-collapse',\r\n  styleUrl: 'collapse.scss',\r\n  shadow: true,\r\n})\r\nexport class AthCollapse {\r\n  private timeoutHideContent: NodeJS.Timeout;\r\n  private timeoutChangeOverflow: NodeJS.Timeout;\r\n  private animationtime = 500;\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * If the component is expanded by default\r\n   */\r\n  @Prop({ mutable: true, reflect: true }) show = false;\r\n\r\n  @State() isExpanded: boolean;\r\n  @State() collapseHeight: string;\r\n  @State() overflowHidden: boolean = true;\r\n\r\n  /**\r\n   * Event to emit if the component is expanded or collapsed.\r\n   */\r\n  @Event() athCollapseState: EventEmitter<{ id: string; isExpanded: boolean }>;\r\n\r\n  @Listen('athToggleCollapse', { target: 'window' })\r\n  handleCollapse(event: CustomEvent<string>) {\r\n    const targetId = event.detail;\r\n\r\n    if (!targetId || targetId !== this.el?.id) return;\r\n\r\n    this.isExpanded = !this.isExpanded;\r\n    this.athCollapseState.emit({ id: this.el.id, isExpanded: this.isExpanded });\r\n\r\n    clearTimeout(this.timeoutHideContent);\r\n    clearTimeout(this.timeoutChangeOverflow);\r\n\r\n    if (this.isExpanded) {\r\n      this.show = true;\r\n      this.timeoutChangeOverflow = setTimeout(() => {\r\n        this.overflowHidden = false;\r\n      }, this.animationtime);\r\n    } else {\r\n      this.timeoutHideContent = setTimeout(() => (this.show = false), this.animationtime);\r\n      this.overflowHidden = true;\r\n    }\r\n  }\r\n\r\n  @Listen('resize', { target: 'window' })\r\n  handleResize() {\r\n    this.getCollapseHeight();\r\n  }\r\n\r\n  @Watch('isExpanded')\r\n  async handleExpanded() {\r\n    await this.getCollapseHeight();\r\n  }\r\n\r\n  private getClassNames = () => ({\r\n    'ath-collapse': true,\r\n    'ath-collapse--expanded': this.isExpanded,\r\n    'ath-collapse--collapsed': !this.isExpanded,\r\n    'ath-collapse--overflow-hidden': this.overflowHidden,\r\n  });\r\n\r\n  private getCollapseHeight = async () => {\r\n    await new Promise(resolve => setTimeout(resolve, 0));\r\n    await new Promise(resolve => requestAnimationFrame(resolve));\r\n\r\n    const collapseElement = this.el.shadowRoot?.querySelector('.ath-collapse') as HTMLElement;\r\n    if (collapseElement && this.isExpanded) {\r\n      const prevHeight = collapseElement.style.height;\r\n      collapseElement.style.height = 'auto';\r\n      const newHeight = collapseElement.scrollHeight;\r\n      collapseElement.style.height = prevHeight;\r\n\r\n      await new Promise(resolve => requestAnimationFrame(resolve));\r\n      this.collapseHeight = `${newHeight}px`;\r\n    } else {\r\n      this.collapseHeight = '0px';\r\n    }\r\n  };\r\n\r\n  componentWillLoad() {\r\n    this.isExpanded = this.show;\r\n    this.athCollapseState.emit({ id: this.el?.id, isExpanded: this.isExpanded });\r\n  }\r\n\r\n  componentDidLoad() {\r\n    this.getCollapseHeight();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    clearTimeout(this.timeoutHideContent);\r\n    clearTimeout(this.timeoutChangeOverflow);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div>\r\n          <div class={this.getClassNames()} style={{ height: this.collapseHeight }}>\r\n            {this.show && <slot></slot>}\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}