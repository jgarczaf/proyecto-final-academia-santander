{"version":3,"file":"fc-calendar-month.js","sourceRoot":"","sources":["../../../../src/sharedfc/datepicker/calendar-month/fc-calendar-month.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAuB,CAAC,EAAE,MAAM,eAAe,CAAC;AACvD,OAAO,EAAE,gBAAgB,EAAE,MAAM,uCAAuC,CAAC;AACzE,OAAO,EACL,UAAU,EACV,aAAa,EACb,iBAAiB,EACjB,SAAS,EACT,eAAe,EACf,oBAAoB,EACpB,gBAAgB,EAChB,gBAAgB,GACjB,MAAM,mBAAmB,CAAC;AAqB3B,MAAM,CAAC,MAAM,eAAe,GAA6C,KAAK,CAAC,EAAE;IAC/E,MAAM,aAAa,GAAG,UAAU,CAAC,KAAK,CAAC,UAAU,IAAI,KAAK,CAAC,aAAa,IAAI,IAAI,IAAI,EAAE,CAAC,CAAC;IAExF,SAAS,SAAS;QAChB,MAAM,MAAM,GAAa,EAAE,CAAC;QAC5B,IAAI,GAAG,GAAW,EAAE,CAAC;QAErB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,EAAE,EAAE,KAAK,EAAE,EAAE,CAAC;YACxC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;YACpE,IAAI,KAAK,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC;gBACpB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACjB,GAAG,GAAG,EAAE,CAAC,CAAC,mCAAmC;YAC/C,CAAC;QACH,CAAC;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,SAAS,eAAe,CAAC,KAAW;QAClC,OAAO,CACL,eAAe,CAAC,KAAK,EAAE,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC;YAC3E,CAAC,KAAK,CAAC,cAAc,IAAI,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,CAClF,CAAC;IACJ,CAAC;IAED,SAAS,kBAAkB,CAAC,KAAW;QACrC,OAAO,CACL,eAAe,CAAC,KAAK,EAAE,KAAK,CAAC,gBAAgB,CAAC;YAC9C,CAAC,KAAK,CAAC,iBAAiB,IAAI,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,CACxF,CAAC;IACJ,CAAC;IAED,SAAS,eAAe,CAAC,KAAW;QAClC,IAAI,KAAK,CAAC,aAAa,EAAE,CAAC;YACxB,OAAO,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC;QACnD,CAAC;QAED,IAAI,KAAK,CAAC,kBAAkB,IAAI,CAAC,KAAK,CAAC,gBAAgB,EAAE,CAAC;YACxD,OAAO,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,kBAAkB,CAAC,CAAC;QACxD,CAAC;QAED,IAAI,KAAK,CAAC,gBAAgB,IAAI,CAAC,KAAK,CAAC,kBAAkB,EAAE,CAAC;YACxD,OAAO,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,gBAAgB,CAAC,CAAC;QACtD,CAAC;QAED,IAAI,KAAK,CAAC,kBAAkB,IAAI,KAAK,CAAC,gBAAgB,IAAI,aAAa,CAAC,KAAK,CAAC,kBAAkB,EAAE,KAAK,CAAC,gBAAgB,CAAC,EAAE,CAAC;YAC1H,OAAO,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,kBAAkB,CAAC,CAAC;QACxD,CAAC;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,SAAS,aAAa,CAAC,KAAW;QAChC,OAAO,KAAK,CAAC,kBAAkB,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC,kBAAkB,IAAI,KAAK,GAAG,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC,KAAK,CAAC;IACzI,CAAC;IAED,SAAS,YAAY,CAAC,KAAW;QAC/B,OAAO,KAAK,CAAC,kBAAkB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;IACtH,CAAC;IAED,SAAS,UAAU,CAAC,KAAW;QAC7B,OAAO,KAAK,CAAC,gBAAgB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;IAClH,CAAC;IAED,SAAS,SAAS,CAAC,GAAkB,EAAE,KAAW;QAChD,IAAI,QAAQ,GAAgB,IAAI,CAAC;QACjC,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,QAAQ,GAAG,CAAC,IAAI,EAAE,CAAC;YACjB,KAAK,WAAW;gBACd,QAAQ,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC/B,MAAM,GAAG,IAAI,CAAC;gBACd,MAAM;YAER,KAAK,SAAS;gBACZ,QAAQ,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,MAAM,GAAG,KAAK,CAAC;gBACf,MAAM;YAER,KAAK,WAAW;gBACd,QAAQ,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,MAAM,GAAG,KAAK,CAAC;gBACf,MAAM;YAER,KAAK,YAAY;gBACf,QAAQ,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC/B,MAAM,GAAG,IAAI,CAAC;gBACd,MAAM;YAER,KAAK,OAAO,CAAC;YACb,KAAK,OAAO;gBACV,GAAG,CAAC,eAAe,EAAE,CAAC;gBACtB,GAAG,CAAC,cAAc,EAAE,CAAC;gBACrB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,EAAE,CAAC;oBAC5B,KAAK,CAAC,aAAa,CAAC,IAAI,EAAE,oBAAoB,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACzF,CAAC;gBACD,OAAO;YACT,KAAK,MAAM;gBACT,QAAQ,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;gBAClF,MAAM,GAAG,IAAI,CAAC;gBACd,MAAM;YAER,KAAK,KAAK;gBACR,QAAQ,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;gBACtF,MAAM,GAAG,KAAK,CAAC;gBACf,MAAM;YAER,KAAK,QAAQ;gBACX,QAAQ,GAAG,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;gBACjC,MAAM,GAAG,KAAK,CAAC;gBACf,MAAM;YACR,KAAK,UAAU;gBACb,QAAQ,GAAG,SAAS,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;gBAChC,MAAM,GAAG,IAAI,CAAC;gBACd,MAAM;YACR,KAAK,QAAQ;gBACX,GAAG,CAAC,eAAe,EAAE,CAAC;gBACtB,GAAG,CAAC,cAAc,EAAE,CAAC;gBACrB,KAAK,CAAC,MAAM,EAAE,CAAC;gBACf,OAAO;YACT;gBACE,OAAO;QACX,CAAC;QACD,GAAG,CAAC,eAAe,EAAE,CAAC;QACtB,GAAG,CAAC,cAAc,EAAE,CAAC;QAErB,IAAI,GAAG,CAAC,OAAO,EAAE,CAAC;YAChB,IAAI,MAAM,EAAE,CAAC;gBACX,KAAK,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,QAAQ,EAAE,KAAK,CAAC,cAAc,IAAI,EAAE,EAAE,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;YACnH,CAAC;iBAAM,CAAC;gBACN,KAAK,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,QAAQ,EAAE,KAAK,CAAC,cAAc,IAAI,EAAE,EAAE,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;YACnH,CAAC;QACH,CAAC;aAAM,CAAC;YACN,KAAK,CAAC,kBAAkB,CAAC,oBAAoB,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC3F,CAAC;IACH,CAAC;IAED,OAAO,CACL,aAAO,IAAI,EAAC,MAAM,EAAC,KAAK,EAAC,mBAAmB;QAC1C,aAAO,KAAK,EAAC,yBAAyB,IACnC,SAAS,EAAE,CAAC,GAAG,CAAC,CAAC,GAAW,EAAE,EAAE,CAAC,CAChC,UAAI,KAAK,EAAC,+BAA+B,IACtC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAChB,EAAC,gBAAgB,IACf,mBAAmB,EAAE,EAAE,CAAC,EAAE;gBACxB,IAAI,EAAE,IAAI,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC;oBACjD,IAAI,KAAK,CAAC,QAAQ,EAAE,CAAC;wBACnB,UAAU,CAAC,GAAG,EAAE;4BACd,EAAE,CAAC,KAAK,EAAE,CAAC;wBACb,CAAC,EAAE,CAAC,CAAC,CAAC;oBACR,CAAC;gBACH,CAAC;YACH,CAAC,EACD,QAAQ,EAAE,KAAK,CAAC,aAAa,EAC7B,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,EAAE,KAAK,CAAC,EACnC,KAAK,EAAE,KAAK,EACZ,IAAI,EAAE,OAAO,EACb,WAAW,EAAE,aAAa,CAAC,KAAK,EAAE,aAAa,CAAC,EAChD,UAAU,EAAE,eAAe,CAAC,KAAK,CAAC,EAClC,SAAS,EAAE,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,YAAY,CAAC,EACnD,UAAU,EAAE,eAAe,CAAC,KAAK,CAAC,EAClC,OAAO,EAAE,YAAY,CAAC,KAAK,CAAC,EAC5B,QAAQ,EAAE,aAAa,CAAC,KAAK,CAAC,EAC9B,KAAK,EAAE,UAAU,CAAC,KAAK,CAAC,EACxB,aAAa,EAAE,kBAAkB,CAAC,KAAK,CAAC,EACxC,KAAK,EAAE,KAAK,CAAC,KAAK,EAClB,IAAI,EAAE,iBAAiB,CAAC,KAAK,CAAC,GACZ,CACrB,CAAC,CACC,CACN,CAAC,CACI,CACF,CACT,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import { FunctionalComponent, h } from '@stencil/core';\r\nimport { FcDatepickerItem } from '../datepicker-item/fc-datepicker-item';\r\nimport {\r\n  monthStart,\r\n  compareMonths,\r\n  getMonthNameShort,\r\n  addMonths,\r\n  isCompleteMonth,\r\n  getDateBetweenLimits,\r\n  findNextValidDay,\r\n  findPrevValidDay,\r\n} from '@utils/date-utils';\r\n\r\nexport type FcCalendarMonthType = {\r\n  shownMonth?: Date;\r\n  selectedMonth?: Date;\r\n  selectedRangeStart?: Date;\r\n  selectedRangeEnd?: Date;\r\n  currentMonth?: Date;\r\n  disabledDates?: Date[];\r\n  highlightedDates?: Date[];\r\n  disabledMonths?: Date[];\r\n  highlightedMonths?: Date[];\r\n  color?: string;\r\n  minMonth?: Date;\r\n  maxMonth?: Date;\r\n  hasFocus?: boolean;\r\n  onMonthSelect: (e: MouseEvent, day: Date) => void;\r\n  onChangeShownMonth?: (day: Date) => void;\r\n  onExit?: () => void;\r\n};\r\n\r\nexport const FcCalendarMonth: FunctionalComponent<FcCalendarMonthType> = props => {\r\n  const referenceDate = monthStart(props.shownMonth || props.selectedMonth || new Date());\r\n\r\n  function getMonths(): Date[][] {\r\n    const months: Date[][] = [];\r\n    let row: Date[] = [];\r\n\r\n    for (let index = 0; index < 12; index++) {\r\n      row.push(new Date(new Date(referenceDate.getFullYear(), index, 1)));\r\n      if (index % 3 === 2) {\r\n        months.push(row);\r\n        row = []; // Clear the array for the next row\r\n      }\r\n    }\r\n    return months;\r\n  }\r\n\r\n  function isDisabledMonth(month: Date): boolean {\r\n    return (\r\n      isCompleteMonth(month, props.disabledDates, props.minMonth, props.maxMonth) ||\r\n      (props.disabledMonths && props.disabledMonths.some(d => compareMonths(month, d)))\r\n    );\r\n  }\r\n\r\n  function isHighlightedMonth(month: Date): boolean {\r\n    return (\r\n      isCompleteMonth(month, props.highlightedDates) ||\r\n      (props.highlightedMonths && props.highlightedMonths.some(d => compareMonths(month, d)))\r\n    );\r\n  }\r\n\r\n  function isSelectedMonth(month: Date) {\r\n    if (props.selectedMonth) {\r\n      return compareMonths(month, props.selectedMonth);\r\n    }\r\n\r\n    if (props.selectedRangeStart && !props.selectedRangeEnd) {\r\n      return compareMonths(month, props.selectedRangeStart);\r\n    }\r\n\r\n    if (props.selectedRangeEnd && !props.selectedRangeStart) {\r\n      return compareMonths(month, props.selectedRangeEnd);\r\n    }\r\n\r\n    if (props.selectedRangeStart && props.selectedRangeEnd && compareMonths(props.selectedRangeStart, props.selectedRangeEnd)) {\r\n      return compareMonths(month, props.selectedRangeStart);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function isMiddleMonth(month: Date) {\r\n    return props.selectedRangeStart && props.selectedRangeEnd ? month > props.selectedRangeStart && month < props.selectedRangeEnd : false;\r\n  }\r\n\r\n  function isStartMonth(month: Date) {\r\n    return props.selectedRangeStart && !isSelectedMonth(month) ? compareMonths(month, props.selectedRangeStart) : false;\r\n  }\r\n\r\n  function isEndMonth(month: Date) {\r\n    return props.selectedRangeEnd && !isSelectedMonth(month) ? compareMonths(month, props.selectedRangeEnd) : false;\r\n  }\r\n\r\n  function onKeyDown(key: KeyboardEvent, month: Date) {\r\n    let nextDate: Date | null = null;\r\n    let isNext = true;\r\n    switch (key.code) {\r\n      case 'ArrowDown':\r\n        nextDate = addMonths(month, 3);\r\n        isNext = true;\r\n        break;\r\n\r\n      case 'ArrowUp':\r\n        nextDate = addMonths(month, -3);\r\n        isNext = false;\r\n        break;\r\n\r\n      case 'ArrowLeft':\r\n        nextDate = addMonths(month, -1);\r\n        isNext = false;\r\n        break;\r\n\r\n      case 'ArrowRight':\r\n        nextDate = addMonths(month, 1);\r\n        isNext = true;\r\n        break;\r\n\r\n      case 'Enter':\r\n      case 'Space':\r\n        key.stopPropagation();\r\n        key.preventDefault();\r\n        if (!isDisabledMonth(month)) {\r\n          props.onMonthSelect(null, getDateBetweenLimits(month, props.minMonth, props.maxMonth));\r\n        }\r\n        return;\r\n      case 'Home':\r\n        nextDate = new Date(month.getFullYear(), Math.floor(month.getMonth() / 3) * 3, 1);\r\n        isNext = true;\r\n        break;\r\n\r\n      case 'End':\r\n        nextDate = new Date(month.getFullYear(), Math.floor(month.getMonth() / 3) * 3 + 2, 1);\r\n        isNext = false;\r\n        break;\r\n\r\n      case 'PageUp':\r\n        nextDate = addMonths(month, -12);\r\n        isNext = false;\r\n        break;\r\n      case 'PageDown':\r\n        nextDate = addMonths(month, 12);\r\n        isNext = true;\r\n        break;\r\n      case 'Escape':\r\n        key.stopPropagation();\r\n        key.preventDefault();\r\n        props.onExit();\r\n        return;\r\n      default:\r\n        return;\r\n    }\r\n    key.stopPropagation();\r\n    key.preventDefault();\r\n\r\n    if (key.ctrlKey) {\r\n      if (isNext) {\r\n        props.onChangeShownMonth(findNextValidDay(nextDate, props.disabledMonths || [], props.minMonth, props.maxMonth));\r\n      } else {\r\n        props.onChangeShownMonth(findPrevValidDay(nextDate, props.disabledMonths || [], props.minMonth, props.maxMonth));\r\n      }\r\n    } else {\r\n      props.onChangeShownMonth(getDateBetweenLimits(nextDate, props.minMonth, props.maxMonth));\r\n    }\r\n  }\r\n\r\n  return (\r\n    <table role=\"grid\" class=\"fc-calendar-month\">\r\n      <tbody class=\"fc-calendar-month__rows\">\r\n        {getMonths().map((row: Date[]) => (\r\n          <tr class=\"fc-calendar-month__row-months\">\r\n            {row.map(month => (\r\n              <FcDatepickerItem\r\n                onDatepickerItemRef={el => {\r\n                  if (el && compareMonths(month, props.shownMonth)) {\r\n                    if (props.hasFocus) {\r\n                      setTimeout(() => {\r\n                        el.focus();\r\n                      }, 1);\r\n                    }\r\n                  }\r\n                }}\r\n                onSelect={props.onMonthSelect}\r\n                onKeyDown={e => onKeyDown(e, month)}\r\n                value={month}\r\n                type={'month'}\r\n                isFocusable={compareMonths(month, referenceDate)}\r\n                isDisabled={isDisabledMonth(month)}\r\n                isCurrent={compareMonths(month, props.currentMonth)}\r\n                isSelected={isSelectedMonth(month)}\r\n                isStart={isStartMonth(month)}\r\n                isMiddle={isMiddleMonth(month)}\r\n                isEnd={isEndMonth(month)}\r\n                isHighlighted={isHighlightedMonth(month)}\r\n                color={props.color}\r\n                text={getMonthNameShort(month)}\r\n              ></FcDatepickerItem>\r\n            ))}\r\n          </tr>\r\n        ))}\r\n      </tbody>\r\n    </table>\r\n  );\r\n};\r\n"]}