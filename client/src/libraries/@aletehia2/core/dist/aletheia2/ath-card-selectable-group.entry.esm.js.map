{"version":3,"file":"ath-card-selectable-group.entry.esm.js","sources":["src/components/card-selectable/card-selectable-group/card-selectable-group.model.ts","src/components/card-selectable/card-selectable-group/card-selectable-group.tsx"],"sourcesContent":["export type CardSelectableGroupSizes = 'sm' | 'md';\r\n\r\nexport enum CardSelectableGroupSize {\r\n  Small = 'sm',\r\n  Medium = 'md',\r\n}\r\n","import { Component, ComponentInterface, Host, Prop, h, Event, EventEmitter, Listen, Element } from '@stencil/core';\r\nimport { CardSelectableGroupSize, CardSelectableGroupSizes } from './card-selectable-group.model';\r\n\r\n@Component({\r\n  tag: 'ath-card-selectable-group',\r\n})\r\nexport class AthCardSelectableGroup implements ComponentInterface {\r\n  @Element() el: HTMLAthCardSelectableGroupElement;\r\n\r\n  /**\r\n   * Indicates whether the card selectable group is disabled\r\n   **/\r\n  @Prop() disabled = false;\r\n\r\n  /**\r\n   * Indicates whether the group is multi selection\r\n   **/\r\n  @Prop() multiple = false;\r\n\r\n  /**\r\n   * Size for the cards\r\n   */\r\n  @Prop() size: CardSelectableGroupSizes = CardSelectableGroupSize.Small;\r\n\r\n  @Event() athValueChanged: EventEmitter<HTMLAthCardSelectableElement[]>;\r\n\r\n  private cards: Array<HTMLAthCardSelectableElement> = [];\r\n  private selectedCard: number;\r\n  private firstEnabledCard: number;\r\n  private lastEnabledCard: number;\r\n\r\n  private firstTimeLoad = true;\r\n\r\n  @Listen('keydown')\r\n  handleKeyDown(e: KeyboardEvent) {\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        this.movePreviousCard();\r\n        break;\r\n\r\n      case 'ArrowRight':\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        this.moveNextCard();\r\n        break;\r\n\r\n      case 'Home':\r\n        e.preventDefault();\r\n        this.selectFocusCard(this.firstEnabledCard);\r\n        break;\r\n      case 'End':\r\n        e.preventDefault();\r\n        this.selectFocusCard(this.lastEnabledCard);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  @Listen('athChange')\r\n  handleChange(e: CustomEvent) {\r\n    if (!this.multiple) {\r\n      this.removePreviousCheckedCards(e.detail);\r\n    }\r\n    e.detail.select(this.firstTimeLoad);\r\n\r\n    this.cards.forEach((card, index) => {\r\n      if (card === e.detail) {\r\n        this.selectedCard = index;\r\n      } else {\r\n        card.tabIndex = -1;\r\n      }\r\n    });\r\n\r\n    this.emitCheckedCards();\r\n  }\r\n\r\n  private emitCheckedCards(): void {\r\n    const cards = this.cards.filter(card => card.selected);\r\n    this.athValueChanged.emit(cards);\r\n  }\r\n\r\n  private removePreviousCheckedCards(currentCard: HTMLAthCardSelectableElement) {\r\n    this.cards.forEach(card => {\r\n      if (card.selected && card !== currentCard) {\r\n        card.unselect();\r\n        card.tabIndex = -1;\r\n        card.selected = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  private moveNextCard() {\r\n    const next = this.cards.findIndex((card, index) => index > this.selectedCard && !card.disabled);\r\n    this.selectFocusCard(next === -1 ? this.firstEnabledCard : next);\r\n  }\r\n\r\n  private movePreviousCard() {\r\n    let prevIndex = this.selectedCard - 1;\r\n\r\n    while (prevIndex >= 0 && this.cards[prevIndex].disabled) {\r\n      prevIndex--;\r\n    }\r\n\r\n    this.selectFocusCard(prevIndex === -1 ? this.lastEnabledCard : prevIndex);\r\n  }\r\n\r\n  private getFirstEnabledCard(): number {\r\n    return this.cards.findIndex(card => !card.disabled);\r\n  }\r\n\r\n  private getLastEnabledCard(): number {\r\n    for (let index = this.cards.length - 1; index >= 0; index--) {\r\n      if (!this.cards[index].disabled) {\r\n        return index;\r\n      }\r\n    }\r\n\r\n    return -1;\r\n  }\r\n\r\n  private getFirstCheckedCard(): number {\r\n    const index = this.cards.findIndex(card => card.selected && !card.disabled);\r\n    return index;\r\n  }\r\n\r\n  private selectFocusCard(index: number) {\r\n    this.selectedCard = index;\r\n    this.cards.forEach(card => {\r\n      card.unselect();\r\n      card.tabIndex = -1;\r\n    });\r\n    if (this.cards.length > 0) {\r\n      this.cards[this.selectedCard].select(this.firstTimeLoad);\r\n      this.cards[this.selectedCard].tabIndex = 0;\r\n      this.firstTimeLoad = false;\r\n    }\r\n  }\r\n\r\n  private loadCards(): void {\r\n    this.cards = this.getCards();\r\n    this.firstEnabledCard = this.getFirstEnabledCard();\r\n    this.lastEnabledCard = this.getLastEnabledCard();\r\n\r\n    const firstChecked = this.getFirstCheckedCard();\r\n    this.selectFocusCard(firstChecked > -1 ? firstChecked : this.firstEnabledCard);\r\n  }\r\n\r\n  private getCards(): Array<HTMLAthCardSelectableElement> {\r\n    const cardsElements = this.el.querySelectorAll('ath-card-selectable');\r\n    const cards = [];\r\n\r\n    if (cardsElements) {\r\n      cardsElements.forEach(card => {\r\n        cards.push(card);\r\n      });\r\n    }\r\n\r\n    return cards;\r\n  }\r\n\r\n  private propagateAttributes() {\r\n    if (this.cards.length > 0) {\r\n      this.cards.forEach(card => {\r\n        this.propagateAttribute(card);\r\n      });\r\n    }\r\n  }\r\n\r\n  private propagateAttribute(card: HTMLAthCardSelectableElement) {\r\n    if (this.disabled !== null && !card.hasAttribute('disabled')) {\r\n      card.setAttribute('disabled', this.disabled.toString());\r\n    }\r\n\r\n    if (this.size && !card.hasAttribute('size')) {\r\n      card.setAttribute('size', this.size);\r\n    }\r\n\r\n    if (this.multiple) {\r\n      card.type = 'multiselect';\r\n    }\r\n  }\r\n\r\n  componentDidLoad(): void {\r\n    this.loadCards();\r\n    this.propagateAttributes();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host role={this.multiple ? 'group' : 'radiogroup'}>\r\n        <slot />\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}