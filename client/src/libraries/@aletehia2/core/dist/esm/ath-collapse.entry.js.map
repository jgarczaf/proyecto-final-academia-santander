{"version":3,"file":"ath-collapse.entry.js","sources":["src/components/collapse/collapse.scss?tag=ath-collapse&encapsulation=shadow","src/components/collapse/collapse.tsx"],"sourcesContent":[":host {\r\n  .ath-collapse {\r\n    transition: height 0.5s;\r\n    color: var(--ath-color-fg-default);\r\n\r\n    &--overflow-hidden {\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n","import { Component, Element, Event, EventEmitter, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'ath-collapse',\r\n  styleUrl: 'collapse.scss',\r\n  shadow: true,\r\n})\r\nexport class AthCollapse {\r\n  private timeoutHideContent: NodeJS.Timeout;\r\n  private timeoutChangeOverflow: NodeJS.Timeout;\r\n  private animationtime = 500;\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * If the component is expanded by default\r\n   */\r\n  @Prop({ mutable: true, reflect: true }) show = false;\r\n\r\n  @State() isExpanded: boolean;\r\n  @State() collapseHeight: string;\r\n  @State() overflowHidden: boolean = true;\r\n\r\n  /**\r\n   * Event to emit if the component is expanded or collapsed.\r\n   */\r\n  @Event() athCollapseState: EventEmitter<{ id: string; isExpanded: boolean }>;\r\n\r\n  @Listen('athToggleCollapse', { target: 'window' })\r\n  handleCollapse(event: CustomEvent<string>) {\r\n    const targetId = event.detail;\r\n\r\n    if (!targetId || targetId !== this.el?.id) return;\r\n\r\n    this.isExpanded = !this.isExpanded;\r\n    this.athCollapseState.emit({ id: this.el.id, isExpanded: this.isExpanded });\r\n\r\n    clearTimeout(this.timeoutHideContent);\r\n    clearTimeout(this.timeoutChangeOverflow);\r\n\r\n    if (this.isExpanded) {\r\n      this.show = true;\r\n      this.timeoutChangeOverflow = setTimeout(() => {\r\n        this.overflowHidden = false;\r\n      }, this.animationtime);\r\n    } else {\r\n      this.timeoutHideContent = setTimeout(() => (this.show = false), this.animationtime);\r\n      this.overflowHidden = true;\r\n    }\r\n  }\r\n\r\n  @Listen('resize', { target: 'window' })\r\n  handleResize() {\r\n    this.getCollapseHeight();\r\n  }\r\n\r\n  @Watch('isExpanded')\r\n  async handleExpanded() {\r\n    await this.getCollapseHeight();\r\n  }\r\n\r\n  private getClassNames = () => ({\r\n    'ath-collapse': true,\r\n    'ath-collapse--expanded': this.isExpanded,\r\n    'ath-collapse--collapsed': !this.isExpanded,\r\n    'ath-collapse--overflow-hidden': this.overflowHidden,\r\n  });\r\n\r\n  private getCollapseHeight = async () => {\r\n    await new Promise(resolve => setTimeout(resolve, 0));\r\n    await new Promise(resolve => requestAnimationFrame(resolve));\r\n\r\n    const collapseElement = this.el.shadowRoot?.querySelector('.ath-collapse') as HTMLElement;\r\n    if (collapseElement && this.isExpanded) {\r\n      const prevHeight = collapseElement.style.height;\r\n      collapseElement.style.height = 'auto';\r\n      const newHeight = collapseElement.scrollHeight;\r\n      collapseElement.style.height = prevHeight;\r\n\r\n      await new Promise(resolve => requestAnimationFrame(resolve));\r\n      this.collapseHeight = `${newHeight}px`;\r\n    } else {\r\n      this.collapseHeight = '0px';\r\n    }\r\n  };\r\n\r\n  componentWillLoad() {\r\n    this.isExpanded = this.show;\r\n    this.athCollapseState.emit({ id: this.el?.id, isExpanded: this.isExpanded });\r\n  }\r\n\r\n  componentDidLoad() {\r\n    this.getCollapseHeight();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    clearTimeout(this.timeoutHideContent);\r\n    clearTimeout(this.timeoutChangeOverflow);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div>\r\n          <div class={this.getClassNames()} style={{ height: this.collapseHeight }}>\r\n            {this.show && <slot></slot>}\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}