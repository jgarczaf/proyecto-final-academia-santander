<mat-sidenav-container class="layout-container">
  <!-- SIDENAV -->
  <mat-sidenav
    #sidenav
    class="layout-sidenav"
    fixedInViewport
    [mode]="sidenav.opened ? 'side' : 'over'"
    [opened]="true"
  >
    <mat-nav-list class="sidenav-menu">
      <!-- USER CARD -->
      <div class="user-banner" *ngIf="user as u">
        <div class="user-avatar">
          <mat-icon aria-hidden="true">person</mat-icon>
        </div>
        <div class="user-details">
          <div class="user-name" [title]="u.companyName || u.name || u.email">
            {{
              u.companyName ||
                u.name ||
                (u.email | slice: 0 : u.email.indexOf("@"))
            }}
          </div>
          <div class="user-sub" [title]="u.email">{{ u.email }}</div>
        </div>
      </div>
      <!-- CLIENT MENU -->
      <ng-container *ngIf="auth.hasRole(['CLIENT'])">
        <a mat-list-item (click)="navigate('/client/dashboard')">
          <mat-icon matListIcon>dashboard</mat-icon>
          <span>Dashboard</span>
        </a>

        <a mat-list-item (click)="navigate('/client/debtors')">
          <mat-icon matListIcon>business</mat-icon>
          <span>Deudores</span>
        </a>

        <a mat-list-item (click)="navigate('/client/bills')">
          <mat-icon matListIcon>receipt_long</mat-icon>
          <span>Facturas</span>
        </a>

        <a mat-list-item (click)="navigate('/client/requests')">
          <mat-icon matListIcon>send</mat-icon>
          <span>Solicitudes</span>
        </a>
      </ng-container>

      <!-- ADMIN MENU -->
      <ng-container *ngIf="auth.hasRole(['ADMIN'])">
        <mat-divider></mat-divider>

        <a mat-list-item (click)="navigate('/admin/dashboard')">
          <mat-icon matListIcon>home</mat-icon>
          <span>Dashboard</span>
        </a>

        <a mat-list-item (click)="navigate('/admin/review')">
          <mat-icon matListIcon>work</mat-icon>
          <span>Operaciones</span>
        </a>
        <a mat-list-item>
          <mat-icon matListIcon>person</mat-icon>
          <span>Gestión de clientes</span>
        </a>
        <a mat-list-item>
          <mat-icon matListIcon>notifications</mat-icon>
          <span>Alertas y notificaciones</span>
        </a>
      </ng-container>
    </mat-nav-list>
  </mat-sidenav>

  <!-- MAIN CONTENT -->
  <mat-sidenav-content>
    <!-- TOOLBAR (oscura y a todo el ancho) -->
    <mat-toolbar class="layout-toolbar">
      <button
        mat-icon-button
        (click)="sidenav.toggle()"
        class="menu-btn"
        aria-label="Abrir menú"
      >
        <mat-icon>menu</mat-icon>
      </button>

      <span class="app-title">Factoring Platform</span>
      <span class="flex-spacer"></span>

      <button mat-button class="logout-btn" (click)="logout()">
        <mat-icon>logout</mat-icon>
        <span>Salir</span>
      </button>
    </mat-toolbar>

    <!-- PAGE CONTENT -->
    <div class="layout-content">
      <router-outlet></router-outlet>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
